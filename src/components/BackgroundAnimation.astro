---
---
<div class="relative min-h-screen grow flex justify-center items-center" id="BlockContainer">   
    <slot/>
</div>

<style>
    .test {
        animation: plop 0.3s linear forwards;
        background-color: red;
    }

    @keyframes movingUp {
        0% {
            bottom: -150px;
        }
        100% {
            bottom: -40px;
        }
    }

    @keyframes rotating {
        0% {
            transform: rotate(0);
            
        }
        100% {
            transform: rotate(360deg);
            bottom: 1000px;
            opacity: 0;
        }
    }

    @keyframes plop {
        0 {
            transform: scale(1);
        }
        100% {
            transform: scale(1.4);
            opacity: 0;
        }
    }
</style>

<script>
    let interval:any 
    let intervalRunning:boolean = false

    function startInterval() {
        if(!intervalRunning) {
            interval = setInterval(() => createNewBlock(), 500)
            intervalRunning = true
        }
    }

    function stopInterval() {
        if(intervalRunning) {
            clearInterval(interval)
            intervalRunning = false
        }
    }

    function createNewBlock() {
        const BlockContainer = document.getElementById("BlockContainer")
        const newBlock = document.createElement("div");

        const windowWidth = window.innerWidth

        const randomSize = Math.round(Math.random() * (150 - 50) + 50)
        const randomStart = Math.round(Math.random() * (windowWidth - 0) + 0)
        const randomOpacity = Math.round(Math.random() * (75 - 25) + 25)
        const randomDelay = Math.round(Math.random() * (5 - 1) + 1)
        const randomDuration = Math.round(Math.random() * (15 - 5) + 5)
        const randomBorderRadius = Math.round(Math.random() * (15 - 5) + 5)

        newBlock.style.position = "absolute"
        newBlock.style.bottom = "-40px"
        newBlock.style.border = "1px solid white"
        newBlock.style.boxShadow = "0 0 15px white"
        newBlock.style.backgroundColor = "#64748b"
        newBlock.style.width = randomSize+"px"
        newBlock.style.height = randomSize+"px"
        newBlock.style.left = randomStart+"px"
        newBlock.style.opacity = randomOpacity+"%"
        newBlock.style.borderRadius = randomBorderRadius+"px"

        // newBlock.style.animationName = "rotating"
        //     newBlock.style.animationTimingFunction = "linear"
        //     newBlock.style.animationFillMode = "both"
        //     newBlock.style.animationDelay = randomDelay+"s"
        //     newBlock.style.animationDuration = randomDuration+"s"

        newBlock.style.animationName = "movingUp";
        newBlock.style.animationTimingFunction = "linear"
        newBlock.style.animationFillMode = "both"
        newBlock.style.animationDuration = "1.5s"

        newBlock.addEventListener("animationend", () => {
            // newBlock.remove()

            newBlock.style.animationName = "rotating"
            newBlock.style.animationTimingFunction = "linear"
            newBlock.style.animationFillMode = "both"
            newBlock.style.animationDelay = randomDelay+"s"
            newBlock.style.animationDuration = randomDuration+"s"

            // newBlock.addEventListener("animationend", () => {
                
                // newBlock.style.animationPlayState = 'paused';


                // newBlock.style.animationName = "plop"
                // newBlock.style.animationTimingFunction = "linear"
                // newBlock.style.animationFillMode = "both"
                // newBlock.style.animationDuration = "0.3s"
                // newBlock.style.animationDelay = "0s"

                // newBlock.style.animationPlayState = 'running';
                
                // new Audio("/plop-sound.mp3").play()

                // newBlock.addEventListener("animationend", () => {
                //     newBlock.remove()
                // })
            // })

            // newBlock.addEventListener("animationend", () => {
            //     newBlock.remove()
            // })
        })
        
        

        BlockContainer?.appendChild(newBlock)

        // newBlock.addEventListener("animationstart", () => {
        //     newBlock.addEventListener("click", () => {
        //         newBlock.style.borderRadius = "9999px"
        //     })
        // })

        // newBlock.addEventListener("animationend", () => {
        //     newBlock.remove()
        // })
    }

    document.addEventListener("visibilitychange", () => {
        if (document.hidden) {
            stopInterval()
        } else {
            startInterval()
        }
    })

    startInterval()
</script>